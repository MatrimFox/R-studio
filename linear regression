install.packages("dplyr")
install.packages("readxl")
install.packages("openxlsx")
install.packages("ggplot2")
install.packages("corrplot")
install.packages("corrgram")
install.packages("caTools")
library(dplyr)
library(readxl)
library(openxlsx)
library(ggplot2)
library(corrplot)
library(corrgram)
library(caTools)

df <- read.xlsx("C:\\Users\\Matrim\\Desktop\\Универ 2.0\\Диплом\\Data_students.xlsx")
head(df)
tail(df)
str(df)
summary(df)
#df$Score <- as.numeric(df$Score)
#class(df$Score)

set.seed(101) 
sample <- sample.split(df2$Age, SplitRatio = 0.70) # SplitRatio = percent of sample==TRUE
train = subset(df2, sample == TRUE)
test = subset(df2, sample == FALSE)

model <- lm(Join ~ .,train)
summary(model)


df2 <- df[,-1]
head(df2)
num.cols <- sapply(df2, is.numeric)
cor.data <- cor(df2[,num.cols])
cor.data

corrplot(cor.data,method='color')

corrgram(df2,order=TRUE, lower.panel=panel.shade,
         upper.panel=panel.pie, text.panel=panel.txt)

ggplot(df,aes(x=Score)) + geom_histogram(bins=20,alpha=0.5,fill='blue') + theme_minimal()
